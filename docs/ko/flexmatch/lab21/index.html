<!DOCTYPE html>
<html lang="ko" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.71.1" />
    <meta name="description" content="Full Stack Game Demo">
<meta name="author" content="Jinsung Thomas Park">

    <link rel="icon" href="/aws-gamelift-sample/ko/images/favicon.png" type="image/png">

    <title>Lambda 함수 구성하기 :: GameLift 로 Full Stack Game 시작</title>

    
    <link href="/aws-gamelift-sample/ko/css/nucleus.css?1593160617" rel="stylesheet">
    <link href="/aws-gamelift-sample/ko/css/fontawesome-all.min.css?1593160617" rel="stylesheet">
    <link href="/aws-gamelift-sample/ko/css/hybrid.css?1593160617" rel="stylesheet">
    <link href="/aws-gamelift-sample/ko/css/featherlight.min.css?1593160617" rel="stylesheet">
    <link href="/aws-gamelift-sample/ko/css/perfect-scrollbar.min.css?1593160617" rel="stylesheet">
    <link href="/aws-gamelift-sample/ko/css/auto-complete.css?1593160617" rel="stylesheet">
    <link href="/aws-gamelift-sample/ko/css/atom-one-dark-reasonable.css?1593160617" rel="stylesheet">
    <link href="/aws-gamelift-sample/ko/css/theme.css?1593160617" rel="stylesheet">
    <link href="/aws-gamelift-sample/ko/css/hugo-theme.css?1593160617" rel="stylesheet">
    
      <link href="/aws-gamelift-sample/ko/css/theme-aws.css?1593160617" rel="stylesheet">
    

    <script src="/aws-gamelift-sample/ko/js/jquery-3.3.1.min.js?1593160617"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/aws-gamelift-sample/ko/flexmatch/lab21/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="/aws-gamelift-sample/ko">
	<img src="/aws-gamelift-sample/ko/images/logo.png" height="70px"/>
</a>


<script async src="https://www.googletagmanager.com/gtag/js?id=UA-169409427-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-169409427-1');
</script>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/aws-gamelift-sample/ko/js/lunr.min.js?1593160617"></script>
<script type="text/javascript" src="/aws-gamelift-sample/ko/js/auto-complete.js?1593160617"></script>
<script type="text/javascript">
    
        var baseurl = "\/aws-gamelift-sample\/ko\/\/ko";
    
</script>
<script type="text/javascript" src="/aws-gamelift-sample/ko/js/search.js?1593160617"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/aws-gamelift-sample/ko/intro/" title="GameLift HoL 소개" class="dd-item 
        
        
        
        ">
      <a href="/aws-gamelift-sample/ko/intro/">
          <b>0. </b>GameLift HoL 소개
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/aws-gamelift-sample/ko/intro/lab01/" title="워크샵 내용 구성" class="dd-item 
        
        
        
        ">
      <a href="/aws-gamelift-sample/ko/intro/lab01/">
          <b>0-1. </b>워크샵 내용 구성
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/aws-gamelift-sample/ko/intro/lab02/" title="실습 사전 준비" class="dd-item 
        
        
        
        ">
      <a href="/aws-gamelift-sample/ko/intro/lab02/">
          <b>0-2. </b>실습 사전 준비
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/aws-gamelift-sample/ko/intro/lab03/" title="실습 사전 지식" class="dd-item 
        
        
        
        ">
      <a href="/aws-gamelift-sample/ko/intro/lab03/">
          <b>0-3. </b>실습 사전 지식
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/aws-gamelift-sample/ko/awsservice/" title="풀스택 AWS 서비스 구성" class="dd-item 
        
        
        
        ">
      <a href="/aws-gamelift-sample/ko/awsservice/">
          <b>1. </b>풀스택 AWS 서비스 구성
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/aws-gamelift-sample/ko/awsservice/lab10/" title="CloudFormation 스택 생성" class="dd-item 
        
        
        
        ">
      <a href="/aws-gamelift-sample/ko/awsservice/lab10/">
          <b>1-0. </b>CloudFormation 스택 생성
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/aws-gamelift-sample/ko/awsservice/lab11/" title="DynamoDB 만들기" class="dd-item 
        
        
        
        ">
      <a href="/aws-gamelift-sample/ko/awsservice/lab11/">
          <b>1-1. </b>DynamoDB 만들기
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/aws-gamelift-sample/ko/awsservice/lab12/" title="ElastiCache 구성" class="dd-item 
        
        
        
        ">
      <a href="/aws-gamelift-sample/ko/awsservice/lab12/">
          <b>1-2. </b>ElastiCache 구성
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/aws-gamelift-sample/ko/awsservice/lab13/" title="SQS 생성하기" class="dd-item 
        
        
        
        ">
      <a href="/aws-gamelift-sample/ko/awsservice/lab13/">
          <b>1-3. </b>SQS 생성하기
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/aws-gamelift-sample/ko/awsservice/lab14/" title="IAM 정책 및 역할 생성" class="dd-item 
        
        
        
        ">
      <a href="/aws-gamelift-sample/ko/awsservice/lab14/">
          <b>1-4. </b>IAM 정책 및 역할 생성
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/aws-gamelift-sample/ko/flexmatch/" title="GameLift FlexMatch 실습" class="dd-item 
        parent
        
        
        ">
      <a href="/aws-gamelift-sample/ko/flexmatch/">
          <b>2. </b>GameLift FlexMatch 실습
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/aws-gamelift-sample/ko/flexmatch/lab21/" title="Lambda 함수 구성하기" class="dd-item 
        parent
        active
        
        ">
      <a href="/aws-gamelift-sample/ko/flexmatch/lab21/">
          <b>2-1. </b>Lambda 함수 구성하기
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/aws-gamelift-sample/ko/flexmatch/lab22/" title="API Gateway 구성하기" class="dd-item 
        
        
        
        ">
      <a href="/aws-gamelift-sample/ko/flexmatch/lab22/">
          <b>2-2. </b>API Gateway 구성하기
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/aws-gamelift-sample/ko/flexmatch/lab23/" title="S3 웹 호스팅" class="dd-item 
        
        
        
        ">
      <a href="/aws-gamelift-sample/ko/flexmatch/lab23/">
          <b>2-3. </b>S3 웹 호스팅
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/aws-gamelift-sample/ko/flexmatch/lab24/" title="게임 서버 빌드 &amp; 플릿 생성" class="dd-item 
        
        
        
        ">
      <a href="/aws-gamelift-sample/ko/flexmatch/lab24/">
          <b>2-4. </b>게임 서버 빌드 &amp; 플릿 생성
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/aws-gamelift-sample/ko/flexmatch/lab25/" title="Serverless FlexMatch 구성하기" class="dd-item 
        
        
        
        ">
      <a href="/aws-gamelift-sample/ko/flexmatch/lab25/">
          <b>2-5. </b>Serverless FlexMatch 구성하기
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/aws-gamelift-sample/ko/flexmatch/lab26/" title="FlexMatch 클라이언트와 연결" class="dd-item 
        
        
        
        ">
      <a href="/aws-gamelift-sample/ko/flexmatch/lab26/">
          <b>2-6. </b>FlexMatch 클라이언트와 연결
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/aws-gamelift-sample/ko/flexmatch/lab27/" title="FlexMatch 매치메이킹 이벤트" class="dd-item 
        
        
        
        ">
      <a href="/aws-gamelift-sample/ko/flexmatch/lab27/">
          <b>2-7. </b>FlexMatch 매치메이킹 이벤트
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/aws-gamelift-sample/ko/flexmatch/lab28/" title="FlexMatch 룰셋 테스트" class="dd-item 
        
        
        
        ">
      <a href="/aws-gamelift-sample/ko/flexmatch/lab28/">
          <b>2-8. </b>FlexMatch 룰셋 테스트
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/aws-gamelift-sample/ko/fleetiq/" title="FleetIQ 맛보기" class="dd-item 
        
        
        
        ">
      <a href="/aws-gamelift-sample/ko/fleetiq/">
          <b>3. </b>FleetIQ 맛보기
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/aws-gamelift-sample/ko/fleetiq/lab31/" title="실습 사전 준비" class="dd-item 
        
        
        
        ">
      <a href="/aws-gamelift-sample/ko/fleetiq/lab31/">
          <b>3-1. </b>실습 사전 준비
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/aws-gamelift-sample/ko/fleetiq/lab32/" title="Fiesta IAM 구성" class="dd-item 
        
        
        
        ">
      <a href="/aws-gamelift-sample/ko/fleetiq/lab32/">
          <b>3-2. </b>Fiesta IAM 구성
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/aws-gamelift-sample/ko/fleetiq/lab33/" title="게임 서버 그룹 만들기" class="dd-item 
        
        
        
        ">
      <a href="/aws-gamelift-sample/ko/fleetiq/lab33/">
          <b>3-3. </b>게임 서버 그룹 만들기
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/aws-gamelift-sample/ko/fleetiq/lab34/" title="FleetIQ 기반 서버 생성" class="dd-item 
        
        
        
        ">
      <a href="/aws-gamelift-sample/ko/fleetiq/lab34/">
          <b>3-4. </b>FleetIQ 기반 서버 생성
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/aws-gamelift-sample/ko/fleetiq/lab35/" title="FleetIQ 기반 클라이언트 생성" class="dd-item 
        
        
        
        ">
      <a href="/aws-gamelift-sample/ko/fleetiq/lab35/">
          <b>3-5. </b>FleetIQ 기반 클라이언트 생성
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/aws-gamelift-sample/ko/fleetiq/lab36/" title="서버 - 클라이언트 연동" class="dd-item 
        
        
        
        ">
      <a href="/aws-gamelift-sample/ko/fleetiq/lab36/">
          <b>3-6. </b>서버 - 클라이언트 연동
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/aws-gamelift-sample/ko/gamelift/" title="GameLift Classic 실습 (옵션)" class="dd-item 
        
        
        
        ">
      <a href="/aws-gamelift-sample/ko/gamelift/">
          <b>4. </b>GameLift Classic 실습 (옵션)
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/aws-gamelift-sample/ko/gamelift/lab41/" title="Lambda 함수 구성하기" class="dd-item 
        
        
        
        ">
      <a href="/aws-gamelift-sample/ko/gamelift/lab41/">
          <b>4-1. </b>Lambda 함수 구성하기
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/aws-gamelift-sample/ko/gamelift/lab42/" title="API Gateway 구성하기" class="dd-item 
        
        
        
        ">
      <a href="/aws-gamelift-sample/ko/gamelift/lab42/">
          <b>4-2. </b>API Gateway 구성하기
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/aws-gamelift-sample/ko/gamelift/lab43/" title="S3 웹 호스팅" class="dd-item 
        
        
        
        ">
      <a href="/aws-gamelift-sample/ko/gamelift/lab43/">
          <b>4-3. </b>S3 웹 호스팅
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/aws-gamelift-sample/ko/gamelift/lab44/" title="게임 서버 빌드 &amp; 플릿 생성" class="dd-item 
        
        
        
        ">
      <a href="/aws-gamelift-sample/ko/gamelift/lab44/">
          <b>4-4. </b>게임 서버 빌드 &amp; 플릿 생성
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/aws-gamelift-sample/ko/gamelift/lab45/" title="매치메이커 서버 만들기" class="dd-item 
        
        
        
        ">
      <a href="/aws-gamelift-sample/ko/gamelift/lab45/">
          <b>4-5. </b>매치메이커 서버 만들기
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/aws-gamelift-sample/ko/gamelift/lab46/" title="게임 클라이언트 구성 &amp; 게임 플레이!" class="dd-item 
        
        
        
        ">
      <a href="/aws-gamelift-sample/ko/gamelift/lab46/">
          <b>4-6. </b>게임 클라이언트 구성 &amp; 게임 플레이!
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/aws-gamelift-sample/ko/cleanup/" title="Clean Up" class="dd-item 
        
        
        
        ">
      <a href="/aws-gamelift-sample/ko/cleanup/">
          <b>5. </b>Clean Up
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/aws-gamelift-sample/ko/appendix/" title="부록(Appendix)" class="dd-item 
        
        
        
        ">
      <a href="/aws-gamelift-sample/ko/appendix/">
          <b>6. </b>부록(Appendix)
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
         
    </ul>

    
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
        <li>
          <a class="padding">
            <i class="fas fa-language fa-fw"></i>
          <div class="select-style">
            <select id="select-language" onchange="location = this.value;">
          
          
          
              
              
                  
              
                  
                    
                    
                      <option id="ko" value="/aws-gamelift-sample/ko/flexmatch/lab21/" selected>한국어</option>
                    
                  
              
          
              
              
                  
                    
                    
                      <option id="en" value="/aws-gamelift-sample/en/flexmatch/lab21/">English</option>
                    
                  
              
                  
              
          
        </select>
        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
          width="255px" height="255px" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255;" xml:space="preserve">
          <g>
            <g id="arrow-drop-down">
              <polygon points="0,63.75 127.5,191.25 255,63.75 		" />
            </g>
          </g>
        </svg>
        </div>
        </a>
        </li>
      
      
      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      © 2020 Amazon Web Services, Inc. or its Affiliates. All rights reserved.

    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/aws-gamelift-sample/ko/'>GameLift HoL</a> > <a href='/aws-gamelift-sample/ko/flexmatch/'>GameLift FlexMatch 실습</a> > Lambda 함수 구성하기
          
         
          
         
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#lambda-함수-생성하기-brbr">Lambda 함수 생성하기 <!-- raw HTML omitted --><!-- raw HTML omitted --></a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Lambda 함수 구성하기
            </h1>
          

        




	
<div class="notices tip" ><p>CloudFormation 스택을 배포하셨다면, 이미 Lambda 함수와 API Gateway 의 기본 틀은 마련되어 있습니다. 단계를 진행해보시면서 필요한 부분만 채워주시면 됩니다.</p>
</div>

<h3 id="lambda-함수-생성하기-brbr">Lambda 함수 생성하기 <!-- raw HTML omitted --><!-- raw HTML omitted --></h3>
<p>이전 섹션까지 우리는 full stack game의 가장 기초적인 서비스들을 구성했습니다. 지금부터는 사용자가 게임을 즐기고 게임 결과를 처리할 Lambda 를 구성하겠습니다.</p>
<p>이번 랩에서는 총 3개의 Lambda 함수를 생성할 것입니다.
먼저 첫 번째 Lambda 함수를 작성하는 방법입니다.</p>
<ol>
<li>
<p>콘솔에서 Lambda 메뉴로 이동합니다. <a href="https://console.aws.amazon.com/lambda">https://console.aws.amazon.com/lambda</a></p>
</li>
<li>
<p>Create function 버튼을 클릭하여 첫번째 함수 생성을 시작합니다.</p>
</li>
<li>
<p>Author from scratch 메뉴를 선택하여 빈 함수를 우선 생성합니다.</p>
</li>
<li>
<p>Name 항목에는 game-sqs-process를 입력합니다.</p>
</li>
<li>
<p>Runtime은 Python 2.7을 선택합니다.</p>
</li>
<li>
<p>Permissions 항목에서 Role 은 Use an existing role을 선택하고 기존에 만들어둔 Gomok-game-sqs-process를 선택하고 Create function을 실행합니다.</p>
</li>
<li>
<p>생성이 완료되면 Designer그룹의 Add triggers 하단에 SQS(Simple Queue Service)를 Lambda의 실행 트리거로 선택합니다. 그러면 하단에 Configure triggers 그룹이 생성됩니다.</p>
</li>
</ol>
<p><img src="../../images/flexmatch/lab21/Lambda-1.png" alt="Lambda"></p>
<ol start="8">
<li>SQS queue는 앞서 생성한 SQS의 arn이 선택되어 있는 것을 확인합니다. Enable trigger가 선택된 것을 확인하고 Add 버튼을 선택합니다.</li>
</ol>
<p>Basic settings: 128MB Memory and 1 min timeout</p>
<p><img src="../../images/flexmatch/lab21/Lambda-2.png" alt="Lambda"></p>
<ol start="9">
<li>Designer 그룹으로 돌아와 아래의 생성할 함수의 정보를 참고하여 Lambda 함수를 작성합니다. 소스 경로 최상위의 Lambda 폴더를 보면 GameResultProcessing.py 함수 내용을 참고해서 Lambda 함수를 작성합니다.</li>
</ol>
<p>Code: GameResultProcessing.py 파일의 내용을 Copy&amp;Paste합니다. 코드 내의 region_name 부분은 여러분이 랩을 수행하는 리전으로 되어 있는지 확인합니다. (예: ap-northeast-2)</p>
<p><img src="../../images/flexmatch/lab21/Lambda-3.png" alt="Lambda"></p>

<div class="notices warning" ><p>Lambda 함수 핸들러 정보 구성에 유의합니다. Lambda 함수는 실행 시, Handler 에 지정된 함수를 참고하며 이 때 지정된 함수에 접근 가능해야 합니다.</p>
</div>

<ol start="10">
<li>Save 버튼을 클릭하여 함수를 생성합니다. 생성한 함수는 SQS 에 기록된 게임 결과 점수를 읽어와 DynamoDB 에 업데이트하는 역할을 수행합니다. Lambda 함수는 SQS 대기열을 지속적으로 폴링하며 메시지를 가져와 DynamoDB 에 점수 결과를 반영합니다.</li>
</ol>

<div class="notices tip" ><p><strong>실습의 편의를 위하여 Python Package 를 별도의 바이너리 형태로 제공합니다. 즉, GetRank.py 와 Scoring.py 를 이용한 Lambda 함수 작성은 제공받은 바이너리 안에 Lambda/LambdaDeploy 경로를 참고합니다.</strong> 바이너리 다운로드는 <a href="../../intro/lab02">실습 사전 준비</a> 항목을 참고해주세요.</p>
</div>

<p>두 번째 Lambda 함수는 Python 패키지를 업로드하여 생성합니다.    이전에 생성한 함수는 Python 표준 SDK만을 사용하기 때문에 인라인 편집기를 사용했지만, 다른 Lambda 함수들은 Redis 라이브러리를 참조하기 때문에 배포 패키지를 업로드 하여 함수를 생성할 것입니다. Lambda 함수를 Python 배포 패키지를 업로드하여 생성해볼 수 있는 아주 좋은 기회입니다.</p>
<ol>
<li>
<p>Lambda 폴더 하위에 LambdaDeploy 폴더에 GetRank.py와 Scoring.py라는 두 개의 Python 파일이 보일 것입니다.</p>
</li>
<li>
<p>두 개의 파일 모두 저장한 뒤, 다시 LambdaDeploy.zip으로 압축해줍니다. (참고: “LambdaDeploy”폴더가 압축파일에 포함되면 안됩니다. 즉, GetRank.py 및 Scoring.py파일은 압축파일 내의 루트경로에 있어야 합니다.)</p>
</li>
<li>
<p>배포 패키지를 완성하면 이를 이용해서 Lambda 함수를 생성할 수 있습니다.</p>
</li>
<li>
<p>앞 서와 동일하게 Author from scratch 메뉴를 선택하여 함수 생성을 시작합니다.</p>
</li>
<li>
<p>Name은 game-rank-update으로 지정하고, Runtime은 Python 2.7로 선택하고, Role은 Gomok-game-rank-update을 선택하고 Create function을 누릅니다.</p>
</li>
<li>
<p>Function code 그룹에서 Action Tab 을 눌러 <strong>Upload a .ZIP file</strong>로 선택하고 LambdaDeploy.zip을 업로드합니다.</p>
</li>
<li>
<p>Handler 항목에서는 Scoring.handler 를 입력하고, 환경 변수에 다음과 같이 ElastiCache Endpoint 를 입력해줍니다. <br>
이와 같이 Lambda 의 환경변수를 이용하면, 안전하게 엔드포인트를 관리할 수 있고, 소스에 하드코딩할 필요없이 효율적으로 관리할 수 있습니다.</p>
</li>
</ol>
<p><img src="../../images/flexmatch/lab21/Lambda-41.png" alt="Lambda"></p>
<ul>
<li>다음과 같이 환경변수로 REDIS 엔드포인트를 알맞게 구성합니다.</li>
</ul>
<p><img src="../../images/flexmatch/lab21/Lambda-42.png" alt="Lambda"></p>
<ol start="8">
<li>
<p>하단의 기본 설정 그룹에서 Timeout을 1분으로 변경합니다</p>
</li>
<li>
<p>Network 항목에서 VPC를 기존에 생성한 ElastiCache가 있는 VPC로 선택합니다. 서브넷 항목은 모두 선택하여 주시고, Security Group은 이전에 생성했던 GomokuDefault로 선택하여 주시기 바랍니다</p>
</li>
</ol>
<p><img src="../../images/flexmatch/lab21/Lambda-5.png" alt="Lambda"></p>
<ol start="10">
<li>상단의 Designer 그룹의 Add triggers에서 DynamoDB을 선택합니다.</li>
</ol>
<p><img src="../../images/flexmatch/lab21/Lambda-6.png" alt="Lambda"></p>
<ol start="11">
<li>하단에 Configure triggers그룹에서 GomokuPlayerInfo DynamoDB 테이블을 Trigger 테이블로 사용할 것입니다. 다른 부분은 기본값을 유지하고 Starting position은 수평 트리밍을 선택합니다. Enable trigger를 체크한 뒤 Add 버튼을 클릭합니다.</li>
</ol>
<p><img src="../../images/flexmatch/lab21/Lambda-7.png" alt="Lambda"></p>
<ol start="12">
<li>위의 과정이 완료되면 오른쪽 상단의 Save를 눌러 함수 생성을 완료합니다. (이 단계에서 함수 Test를 누르게 되면 아직 실패합니다.)</li>
</ol>
<p>마지막으로 세번째 Lambda 함수를 생성하겠습니다. 두번째 만든 함수와 동일하게 만들 수 있습니다.</p>
<ol>
<li>
<p>세 번째 함수도 Author from scratch 를 선택하여 생성합니다.</p>
</li>
<li>
<p>Name항목에서 game-rank-reader를 입력하고, Runtime을 Python 2.7로 설정하고 Role을 이전에 만들어둔 Gomok-game-rank-reader를 선택합니다.</p>
</li>
<li>
<p>Create function을 누른 후 함수 코드의 작업 메뉴에서 Upload a .ZIP file을 선택하여 LambdaDeploy.zip을 업로드합니다.</p>
</li>
<li>
<p>Handler 부분에서 <strong>GetRank.handler</strong>를 입력합니다. 역시 환경 변수에 좀 전과 같이 &ldquo;REDIS&rdquo; 를 키로 입력하고 값에 ElastiCache Endpoint 를 입력해줍니다.</p>
</li>
<li>
<p>Basic settings 부분에서 Timeout을 1 min으로 설정합니다. Network 부분에서 이전 함수 동일하게 VPC 를 기존에 생성한 ElastiCache 가 있는 VPC 로 선택합니다. subnet 항목은 모두 선택하여 주시고, Security Group 은 이전에 생성했던 GomokuDefault 로 선택하여 주시기 바랍니다.</p>
</li>
<li>
<p>이제 Save 를 눌러 Lambda 함수를 생성합니다.</p>
</li>
</ol>
<p>여기까지 완료했다면 3 개의 Lambda 함수가 생성된 것을 확인하실 수 있습니다. (CloudFormation 구성의 경우 5개)</p>
<p><img src="../../images/flexmatch/lab21/Lambda-8.png" alt="Lambda"></p>
<p>이제 모든 Lambda 함수는 준비되었습니다. 지금부터는 이 함수를 실행할 방법이 필요합니다. 처음 생성한 두 함수는 SQS와 DynamoDB에 의해 호출될 것입니다. <br>
하지만 마지막 함수는 trigger를 설정하지 않았습니다. 어떻게 해야 해당 함수를 호출할 수 있을까요? 여기에서 API Gateway를 사용할 것입니다. 이 부분은 다음 섹션에서 내용이 이어집니다.</p>
<hr>
<h4 id="함수-흐름-테스트-brbr">함수 흐름 테스트 <!-- raw HTML omitted --><!-- raw HTML omitted --></h4>
<p>여기까지 준비가 되면 Section 1과 2에서 만들어진 여러 요소들이 어떻게 동작하는지를 테스트해 볼 수 있습니다. 간략하게 설명하면 전체 흐름을 보면 SQS에 데이터가 삽입되면 만들어진 Lambda함수가 실행되면서 해당 SQS데이터를 DynamoDB에 업데이트합니다. Dynamo DB에 입력된 데이터는 DynamoDB Stream의 Trigger를 통하여 다른 Lambda함수가 실행되어 Redis Cache가 업데이트 되는 형태를 가지게 됩니다.</p>
<p>간단하게 Redis Cache의 내용을 확인할수는 없으나 전체 흐름이 정상적으로 동작하는지 여부를 테스트 데이터의 입력과 CloudWatch를 통하여 확인해보도록 하겠습니다.</p>
<ol>
<li>Console을 통하여 SQS를 열어줍니다. <a href="https://console.aws.amazon.com/sqs">https://console.aws.amazon.com/sqs</a></li>
<li>위에서 생성한 game-result-queue를 선택하고 화면 위의 Queue Actions버튼을 눌러줍니다.</li>
<li>나오는 메뉴 중에서 Send Message를 선택합니다.</li>
<li>나오는 텍스트 상자에 아래의 JSON을 넣어줍니다. (특수 기호 때문에 붙여 넣기보다는 직접 입력을 추천합니다. 대소문자 구분에 주의하십시요. 정상 동작하지 않을 경우, CloudWatch Logs에 남아 있는 lambda 출력을 확인하세요.)</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{ <span style="color:#f92672">&#34;PlayerName&#34;</span> : <span style="color:#e6db74">&#34;SomeName&#34;</span> , <span style="color:#f92672">&#34;WinDiff&#34;</span> : <span style="color:#ae81ff">1</span>, <span style="color:#f92672">&#34;LoseDiff&#34;</span> : <span style="color:#ae81ff">0</span>, <span style="color:#f92672">&#34;ScoreDiff&#34;</span> : <span style="color:#ae81ff">100</span> }
</code></pre></div><ol start="5">
<li>그리고 Send Message버튼을 눌러줍니다.</li>
<li>이제 DynamoDB콘솔로 옮겨가서 GomokuPlayerInfo 테이블을 열어줍니다. Items 탭을 보면 위에서 넣어준 JSON데이터에 해당하는 항목이 반영되어 있는 것을 확인 할 수 있습니다. (이미 같은 PlayerName에 해당하는 항목이 있다면 Win이 1증가하고 Score가 100증가했을 것입니다.)</li>
</ol>
<ul>
<li>만약 반영이 되지 않을 경우 CloudWatch Logs 를 통해 메시지 처리 내역을 확인해볼 수 있습니다.</li>
</ul>
<hr>
<!-- raw HTML omitted -->





<footer class=" footline" >
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/aws-gamelift-sample/ko/flexmatch/" title="GameLift FlexMatch 실습"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/aws-gamelift-sample/ko/flexmatch/lab22/" title="API Gateway 구성하기" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/aws-gamelift-sample/ko/js/clipboard.min.js?1593160618"></script>
    <script src="/aws-gamelift-sample/ko/js/perfect-scrollbar.min.js?1593160618"></script>
    <script src="/aws-gamelift-sample/ko/js/perfect-scrollbar.jquery.min.js?1593160618"></script>
    <script src="/aws-gamelift-sample/ko/js/jquery.sticky.js?1593160618"></script>
    <script src="/aws-gamelift-sample/ko/js/featherlight.min.js?1593160618"></script>
    <script src="/aws-gamelift-sample/ko/js/highlight.pack.js?1593160618"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/aws-gamelift-sample/ko/js/modernizr.custom-3.6.0.js?1593160618"></script>
    <script src="/aws-gamelift-sample/ko/js/learn.js?1593160618"></script>
    <script src="/aws-gamelift-sample/ko/js/hugo-learn.js?1593160618"></script>

    <link href="/aws-gamelift-sample/ko/mermaid/mermaid.css?1593160618" rel="stylesheet" />
    <script src="/aws-gamelift-sample/ko/mermaid/mermaid.js?1593160618"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    
  </body>
</html>
